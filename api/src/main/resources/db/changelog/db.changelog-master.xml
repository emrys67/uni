<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
   http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="test" author="xtrofymo">
        <createTable tableName="timeperiods">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="start_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="end_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="start_time" type="time">
                <constraints nullable="false"/>
            </column>
            <column name="end_time" type="time">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="vacations">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="description" type="varchar(500)">
                <constraints nullable="true"/>
            </column>
            <column name="time_period_id" type="int">
                <constraints foreignKeyName="time_period_id_fk" references="timeperiods(id)"/>
            </column>
        </createTable>
        <createTable tableName="genders">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(200)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>

        <createTable tableName="teachers">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="firstname" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="lastname" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="date_of_birth" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="gender_id" type="int">
                <constraints nullable="false" foreignKeyName="gender_id_fk" references="genders(id)"/>
            </column>
            <column name="working_hours_id" type="int">
                <constraints nullable="false" foreignKeyName="working_hours_id_fk" references="timeperiods(id)"/>
            </column>
            <column name="vacation_id" type="int">
                <constraints nullable="false" foreignKeyName="vacation_id_fk" references="vacations(id)"/>
            </column>
        </createTable>

        <createTable tableName="students">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="firstname" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="lastname" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="date_of_birth" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="gender_id" type="int">
                <constraints nullable="false" foreignKeyName="gender_id_fk" references="genders(id)"/>
            </column>
            <column name="study_year" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="groups">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(200)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>

        <createTable tableName="classrooms">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="capacity" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="subjects">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(200)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="description" type="varchar(500)">
                <constraints nullable="false"/>
            </column>
            <column name="supervisor_id" type="int">
                <constraints nullable="false" foreignKeyName="supervisor_id_fk" references="teachers(id)"/>
            </column>
        </createTable>

        <createTable tableName="lectures">
            <column name="id" type="serial">
                <constraints primaryKey="true"/>
            </column>
            <column name="teacher_id" type="int">
                <constraints nullable="false" foreignKeyName="teacher_id_fk" references="teachers(id)"/>
            </column>
            <column name="subject_id" type="int">
                <constraints nullable="false" foreignKeyName="subject_id_fk" references="subjects(id)"/>
            </column>
            <column name="time_periods_id" type="int">
                <constraints nullable="false" foreignKeyName="time_periods_id_fk" references="timeperiods(id)"/>
            </column>
            <column name="classroom_id" type="int">
                <constraints nullable="false" foreignKeyName="classroom_id_fk" references="classrooms(id)"/>
            </column>
        </createTable>

        <createTable tableName="subjects_teachers">
            <column name="subject_id" type="int">
                <constraints nullable="false" foreignKeyName="subject_id_fk" references="subjects(id)"/>
            </column>
            <column name="teacher_id" type="int">
                <constraints nullable="false" foreignKeyName="teacher_id_fk" references="teachers(id)"/>
            </column>
        </createTable>

        <createTable tableName="lectures_groups">
            <column name="lecture_id" type="int">
                <constraints nullable="false" foreignKeyName="lecture_id_fk" references="lectures(id)"/>
            </column>
            <column name="group_id" type="int">
                <constraints nullable="false" foreignKeyName="group_id_fk" references="groups(id)"/>
            </column>
        </createTable>
        <createTable tableName="students_groups">
            <column name="student_id" type="int">
                <constraints nullable="false" foreignKeyName="student_id_fk" references="students(id)"/>
            </column>
            <column name="group_id" type="int">
                <constraints nullable="false" foreignKeyName="group_id_fk" references="groups(id)"/>
            </column>
        </createTable>

        <rollback>
            <dropTable tableName="students_groups"/>
            <dropTable tableName="lectures_groups"/>
            <dropTable tableName="subjects_teachers"/>
            <dropTable tableName="lectures"/>
            <dropTable tableName="subjects"/>
            <dropTable tableName="teachers"/>
            <dropTable tableName="students"/>
            <dropTable tableName="groups"/>
            <dropTable tableName="classrooms"/>
            <dropTable tableName="vacations"/>
            <dropTable tableName="genders"/>
            <dropTable tableName="timeperiods"/>
        </rollback>
    </changeSet>

</databaseChangeLog>